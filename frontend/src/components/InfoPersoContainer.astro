<section>
  <p>Mon email : <span class="font-bold" id="email"></span></p>
  <p>Mon identifiant de login : <span class="font-bold" id="login"></span></p>
</section>

<script>
  // if not token, redirect to login page
  if (!localStorage.getItem("token")) {
    window.location.href = "/login";
  }


  try {
    const response = await fetch(`${import.meta.env.PUBLIC_BASE_API_URL}/user/me`, {
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
        "Authorization": `Bearer ${localStorage.getItem("token")}`
      }
    });

    if (!response.ok) {
      throw new Error('Network response was not ok');
    }

    const data = await response.json();

    const emailElement = document.getElementById('email');
    const loginElement = document.getElementById('login');
    if (emailElement && loginElement) {
      emailElement.textContent = data.email;
      loginElement.textContent = data.login;
    }

  } catch (error) {
    console.error('Error fetching user data:', error);
    window.location.href = "/login";
  }
</script>